% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/label_main.R
\name{label_variables}
\alias{label_variables}
\title{Generate Variable Labels Using LLM}
\usage{
label_variables(
  variable_info,
  chat_session = NULL,
  llm_provider = NULL,
  llm_model = NULL,
  label_type = "short",
  max_words = NULL,
  style_hint = NULL,
  sep = " ",
  case = "original",
  remove_articles = FALSE,
  remove_prepositions = FALSE,
  max_chars = NULL,
  abbreviate = FALSE,
  label_args = NULL,
  llm_args = NULL,
  output_args = NULL,
  echo = "none",
  silent = 0
)
}
\arguments{
\item{variable_info}{Data frame with 'description' column (required) and optional
'variable' column. If 'variable' is not provided, names will be auto-generated
as V1, V2, V3, etc.}

\item{chat_session}{Chat session object or NULL. If NULL, creates temporary session}

\item{llm_provider}{Character. LLM provider (e.g., "anthropic", "openai", "ollama").
Required when chat_session is NULL}

\item{llm_model}{Character or NULL. Model name. If NULL and chat_session is NULL,
uses provider's default model}

\item{label_type}{Character. Type of labels: "short" (1-3 words), "phrase" (4-7 words),
"acronym" (3-5 chars), or "custom" (default = "short")}

\item{max_words}{Integer or NULL. \strong{Sets upper limit for word count} (overrides label_type
presets EXCEPT for "acronym"). Instructs the LLM to generate labels with up to this many
words. Also applies post-processing truncation if needed. More effective than using
\code{max_words} in \code{reformat_labels()}. Ignored when label_type = "acronym".}

\item{style_hint}{Character or NULL. Style guidance for LLM (e.g., "technical", "simple",
"academic"). Influences the LLM's choice of terminology and phrasing.}

\item{sep}{Character. Separator between words in final output (default = " ").
Post-processing only - does not affect LLM generation.}

\item{case}{Character. Case transformation: "original", "lower", "upper", "title",
"sentence", "snake", "camel", "constant" (default = "original").
Post-processing only - does not affect LLM generation.}

\item{remove_articles}{Logical. Remove articles (a, an, the) from labels (default = FALSE).
Post-processing only - does not affect LLM generation.}

\item{remove_prepositions}{Logical. Remove prepositions (of, in, at, etc.) (default = FALSE).
Post-processing only - does not affect LLM generation.}

\item{max_chars}{Integer or NULL. \strong{Sets upper limit for character count}. Instructs the LLM
to generate labels within this character limit. Works with ALL label types including
"acronym" (where it controls the acronym length). Also applies post-processing truncation
if needed. More effective than using \code{max_chars} in \code{reformat_labels()}.}

\item{abbreviate}{Logical. Apply rule-based abbreviation to long words (default = FALSE).
Post-processing only - does not affect LLM generation.}

\item{label_args}{List or label_args object. Labeling-specific configuration.
Created with \code{\link{label_args}}. Direct parameters take precedence.}

\item{llm_args}{List or llm_args object. LLM configuration settings.
Created with \code{\link{llm_args}}. Direct parameters take precedence.}

\item{output_args}{List or output_args object. Output configuration settings.
Created with \code{\link{output_args}}. Direct parameters take precedence.}

\item{echo}{Character. Echo level: "none", "output", "all" (default = "none")}

\item{silent}{Integer or logical. Controls output verbosity (default = 0)}
}
\value{
A variable_labels object containing:
\item{labels_formatted}{Data frame with formatted 'variable' and 'label' columns}
\item{labels_parsed}{Data frame with unformatted LLM labels}
\item{variable_info}{Data frame with original variable information (variable, description)}
\item{llm_response}{Raw LLM response text for reformatting}
\item{metadata}{List with label_type, timestamp, and token usage}
\item{chat_session}{Chat session object for reuse or inspection}
}
\description{
Create short, descriptive labels for variables based on their descriptions
using Large Language Models. Supports various label formats and extensive
post-processing options.
}
\details{
The function works in two phases:
\enumerate{
\item \strong{Semantic Generation}: LLM generates natural language labels based on descriptions
\item \strong{Format Processing}: Apply transformations (case, separators, abbreviation, etc.)
}

Special case behaviors:
\itemize{
\item \code{case = "snake"} automatically sets \code{sep = "_"} and lowercase
\item \code{case = "camel"} automatically sets \code{sep = ""} and applies camelCase
\item \code{case = "constant"} automatically sets \code{sep = "_"} and uppercase
}
}
\section{Parameter Organization}{

Parameters are organized into groups:
\itemize{
\item \strong{Core}: variable_info, chat_session, llm_provider, llm_model
\item \strong{Semantic Generation (LLM-facing)}: label_type, max_words, max_chars, style_hint
\item \strong{Format Processing (post-processing)}: case, sep, remove_articles, remove_prepositions, abbreviate
\item \strong{Configuration Objects}: labeling_args, llm_args, output_args
\item \strong{Control}: echo, silent
}
}

\examples{
\dontrun{
# Basic usage with explicit variable names
labels <- label_variables(
  variable_info = data.frame(
    variable = c("q1", "q2", "q3"),
    description = c(
      "How satisfied are you with your job?",
      "Rate your work-life balance",
      "Years of experience"
    )
  ),
  llm_provider = "ollama",
  llm_model = "gpt-oss:20b-cloud"
)

# Variable names are optional - will auto-generate V1, V2, V3, etc.
labels <- label_variables(
  variable_info = data.frame(
    description = c(
      "How satisfied are you with your job?",
      "Rate your work-life balance",
      "Years of experience"
    )
  ),
  llm_provider = "ollama",
  llm_model = "gpt-oss:20b-cloud"
)

# Using configuration objects (dual-tier architecture)
label_config <- label_args(
  label_type = "short",
  case = "snake",
  remove_articles = TRUE
)

llm_config <- llm_args(
  word_limit = 50,
  echo = "none"
)

labels <- label_variables(
  variable_info,
  label_args = label_config,
  llm_args = llm_config,
  llm_provider = "ollama",
  llm_model = "gpt-oss:20b-cloud"
)

# Direct parameters override config objects
labels <- label_variables(
  variable_info,
  label_args = label_config,  # says case = "snake"
  case = "camel",                 # This takes precedence!
  llm_provider = "ollama",
  llm_model = "gpt-oss:20b-cloud"
)

# Reuse chat session for efficiency
chat <- chat_session("label", "ollama", "gpt-oss:20b-cloud")
labels1 <- label_variables(data1, chat_session = chat)
labels2 <- label_variables(data2, chat_session = chat)

# Export results
export_labels(labels, "variable_labels.csv")
}

}
